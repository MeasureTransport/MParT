
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Installation &#8212; MParT  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using MParT" href="getting_started.html" />
    <link rel="prev" title="MParT: Monotone Parameterization Toolbox" href="../index.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">MParT  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started.html">
  Using MParT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="mathematics.html">
  Mathematical Background
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="development/index.html">
  Development
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/MeasureTransport/MParT" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-from-conda">
   Install from Conda
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compiling-from-source">
   Compiling from Source
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compiling-with-julia-bindings">
     Compiling with Julia Bindings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compiling-with-cuda-support">
     Compiling with CUDA Support
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">#</a></h1>
<section id="install-from-conda">
<h2>Install from Conda<a class="headerlink" href="#install-from-conda" title="Permalink to this heading">#</a></h2>
<div class="sphinx-bs container-lg pb-3 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
</div>
<div class="card-body docutils">
<p class="card-text">COMING SOON!</p>
</div>
<div class="card-footer docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install -c conda-forge mpart
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-body docutils">
</div>
</div>
</div>
</div>
</div>
</section>
<section id="compiling-from-source">
<span id="id1"></span><h2>Compiling from Source<a class="headerlink" href="#compiling-from-source" title="Permalink to this heading">#</a></h2>
<p>MParT uses CMake to handle dependencies and compiler configurations.   A basic build of MParT that should work on most operating systems can be obtained with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build
<span class="nb">cd</span> build
cmake                                         <span class="se">\</span>
  -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;your/install/path&gt;  <span class="se">\</span>
  -DKokkos_ENABLE_PTHREAD<span class="o">=</span>ON                  <span class="se">\</span>
  -DKokkos_ENABLE_SERIAL<span class="o">=</span>ON                   <span class="se">\</span>
..
make install
</pre></div>
</div>
<p>This will compile the <code class="code docutils literal notranslate"><span class="pre">mpart</span></code> library and the python bindings. If you are compiling on a multicore machine, you can use <code class="code docutils literal notranslate"><span class="pre">make</span> <span class="pre">-j</span> <span class="pre">N_JOBS</span> <span class="pre">install</span></code>, where <code class="code docutils literal notranslate"><span class="pre">N_JOBS</span></code> is the number of processes the computer can compile with in parallel.  This installation should also automatically install and build Kokkos, Eigen, and Catch2, assuming they aren’t installed already. If CMake has trouble finding prior installations of these, then you can configuring CMake using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> cmake                                        <span class="se">\</span>
  -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;your/install/path&gt;  <span class="se">\</span>
  -DKokkos_ROOT<span class="o">=</span>&lt;your/kokkos/install/root&gt;    <span class="se">\</span>
  -DEigen3_ROOT<span class="o">=</span>&lt;your/eigen3/install/root&gt;    <span class="se">\</span>
  -DCatch2_ROOT<span class="o">=</span>&lt;your/catch2/install/root&gt;    <span class="se">\</span>
  -DKokkos_ENABLE_PTHREAD<span class="o">=</span>ON                  <span class="se">\</span>
  -DKokkos_ENABLE_SERIAL<span class="o">=</span>ON                   <span class="se">\</span>
..
</pre></div>
</div>
<p>Feel free to mix and match previous installations of Eigen, Kokkos, Pybind11, and Catch2 with submodules you don’t already have using these <code class="code docutils literal notranslate"><span class="pre">X_ROOT</span></code> flags. Note that Catch2 and Kokkos in this example will need to be compiled with shared libraries. MParT has not been tested with all versions of all dependencies, but it does require CMake version &gt;=3.13. Further, it has been tested with Kokkos 3.6.0, Eigen 3.4.0, Pybind11 2.9.2, and Catch2 3.0.0-preview3 (there are some issues encountered when compiling MParT with Catch2 3.0.1).</p>
<p>The command <code class="code docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> will also create a test executable called <code class="code docutils literal notranslate"><span class="pre">RunTests</span></code> in the <code class="code docutils literal notranslate"><span class="pre">build</span></code> directory.  The tests can be run with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">RunTests</span>
</pre></div>
</div>
<p>Or, with the additional specification of the number of Kokkos threads to use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">RunTests</span> <span class="o">--</span><span class="n">kokkos</span><span class="o">-</span><span class="n">threads</span><span class="o">=</span><span class="mi">4</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Depending on your python configuration, pybind11 may throw an error during configuration that looks like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CMake</span> <span class="n">Error</span> <span class="ow">in</span> <span class="n">bindings</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">CMakeLists</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span>
  <span class="n">Imported</span> <span class="n">target</span> <span class="s2">&quot;pybind11::module&quot;</span> <span class="n">includes</span> <span class="n">non</span><span class="o">-</span><span class="n">existent</span> <span class="n">path</span>
</pre></div>
</div>
<p>This often results when due to conda environment mismatches, but can typically be circumvented by explicitly setting the path to your python executable.  When calling cmake, add <code class="code docutils literal notranslate"><span class="pre">-DPYTHON_EXECUTABLE=`which</span> <span class="pre">python`</span></code>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>On OSX, using MParT with the system version of python might result in an error with something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">dlopen</span><span class="p">(</span><span class="n">pympart</span><span class="o">.</span><span class="n">so</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">no</span> <span class="n">suitable</span> <span class="n">image</span> <span class="n">found</span><span class="o">.</span>  <span class="n">Did</span> <span class="n">find</span><span class="p">:</span>
    <span class="n">MParT</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">mpart</span><span class="o">/</span><span class="n">pympart</span><span class="o">.</span><span class="n">so</span><span class="p">:</span> <span class="n">mach</span><span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="n">but</span> <span class="n">wrong</span> <span class="n">architecture</span>
    <span class="n">MParT</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">mpart</span><span class="o">/</span><span class="n">pympart</span><span class="o">.</span><span class="n">so</span><span class="p">:</span> <span class="n">mach</span><span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="n">but</span> <span class="n">wrong</span> <span class="n">architecture</span>
</pre></div>
</div>
<p>You can sometimes force OSX to use the x86_64 version of python using the <code class="code docutils literal notranslate"><span class="pre">arch</span></code> executable.   For example, to run a script <code class="code docutils literal notranslate"><span class="pre">test.py</span></code>, you can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arch</span> <span class="o">-</span><span class="n">x86_64</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span> <span class="n">test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<section id="compiling-with-julia-bindings">
<h3>Compiling with Julia Bindings<a class="headerlink" href="#compiling-with-julia-bindings" title="Permalink to this heading">#</a></h3>
<p>By default, MParT will look for Julia during configuration and will attempt to build the Julia bindings if the Julia <code class="code docutils literal notranslate"><span class="pre">CxxWrap</span></code> package is installed.   To install <code class="code docutils literal notranslate"><span class="pre">CxxWrap</span></code>, run the following command in your Julia prompt:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="n">Pkg</span><span class="p">;</span> <span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;CxxWrap&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have Julia installed, but CMake was not able to find it during MParT configuration, you may need to manually specify <code class="code docutils literal notranslate"><span class="pre">JULIA_EXE</span></code> variable during configuration.  For example, adding <code class="code docutils literal notranslate"><span class="pre">-DJULIA_EXE=~/opt/anaconda3/envs/mpart/bin/julia</span></code> will tell CMake to use the Julia executable installed by anaconda in the <code class="code docutils literal notranslate"><span class="pre">mpart</span></code> conda environment.</p>
<p>To prevent the Julia bindings from being compiled, even if Julia and CxxWrap are found, set <code class="code docutils literal notranslate"><span class="pre">MPART_JULIA=OFF</span></code> during the CMake configuration.</p>
</section>
<section id="compiling-with-cuda-support">
<h3>Compiling with CUDA Support<a class="headerlink" href="#compiling-with-cuda-support" title="Permalink to this heading">#</a></h3>
<p>To support a GPU at the moment, you need a few special requirements. Due to the way that Kokkos handles GPU code, MParT must be compiled using a special wrapper around NVCC that Kokkos provides. First, we compile Kokkos with the required options:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake <span class="se">\</span>
    -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;/new/kokkos/install/path&gt; <span class="se">\</span>
    -DBUILD_SHARED_LIBS<span class="o">=</span>ON                            <span class="se">\</span>
    -DKokkos_ENABLE_SERIAL<span class="o">=</span>OFF                        <span class="se">\</span>
    -DKokkos_ENABLE_OPENMP<span class="o">=</span>ON                         <span class="se">\</span>
    -DKokkos_ENABLE_CUDA<span class="o">=</span>ON                           <span class="se">\</span>
    -DKokkos_ARCH_VOLTA70<span class="o">=</span>ON                          <span class="se">\</span>
    -DKokkos_ENABLE_CUDA_LAMBDA<span class="o">=</span>ON                    <span class="se">\</span>
    -DKokkos_CUDA_DIR<span class="o">=</span>&lt;cuda/install/path&gt;             <span class="se">\</span>
    -DKokkos_CXX_STANDARD<span class="o">=</span><span class="m">17</span>                          <span class="se">\</span>
../
</pre></div>
</div>
<p>Replace the <code class="code docutils literal notranslate"><span class="pre">Kokkos_ARCH_VOLTA70</span></code> as needed with whatever other arch the compute resource uses that Kokkos supports. If you aren’t sure, try omitting this as Kokkos has some machinery to detect such architecture.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you’re getting an error about C++ standards, try using a new version of your compiler; <code class="code docutils literal notranslate"><span class="pre">g++</span></code>, for example, does not support the flag <code class="code docutils literal notranslate"><span class="pre">--std=c++17</span></code> below version 8, where <code class="code docutils literal notranslate"><span class="pre">nvcc</span></code> only supports such syntax. For more details, see <a class="reference external" href="https://github.com/kokkos/kokkos/issues/5157">this issue</a> in Kokkos.</p>
</div>
<p>Using the above documentation on building with an external install of Kokkos, we can then configure MParT once in the <code class="code docutils literal notranslate"><span class="pre">build</span></code> directory using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake <span class="se">\</span>
    -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;your/install/path&gt;                       <span class="se">\</span>
    -DKokkos_ROOT<span class="o">=</span>&lt;/new/kokkos/install/path&gt;                         <span class="se">\</span>
    -DCMAKE_CXX_COMPILER<span class="o">=</span>&lt;/new/kokkos/install/path&gt;/bin/nvcc_wrapper <span class="se">\</span>
..
</pre></div>
</div>
<p>Make sure that <code class="code docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code> uses a full path from the root!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you’re using a Power8 or Power9 architecture, Eigen may give you trouble when trying to incorporate vectorization using Altivec, specifically when compiling for GPU. In this case, go into <code class="code docutils literal notranslate"><span class="pre">CMakeFiles.txt</span></code> and add <code class="code docutils literal notranslate"><span class="pre">add_compile_definition(EIGEN_DONT_VECTORIZE)</span></code>.</p>
</div>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../index.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">MParT: Monotone Parameterization Toolbox</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="getting_started.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Using MParT</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, The MParT development team..<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>