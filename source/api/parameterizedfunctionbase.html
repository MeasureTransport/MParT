
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Parameterized Function Base &#8212; MParT  documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/api/parameterizedfunctionbase';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fas fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">MParT  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../getting_started.html">
                        Getting Started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../tutorials/index.html">
                        Tutorials
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../mathematics.html">
                        Mathematical Background
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        API Reference
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../development/index.html">
                        Community
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/MeasureTransport/MParT" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fas fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../installation.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../getting_started.html">
                        Getting Started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../tutorials/index.html">
                        Tutorials
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../mathematics.html">
                        Mathematical Background
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        API Reference
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../development/index.html">
                        Community
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/MeasureTransport/MParT" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="parameterized-function-base">
<h1>Parameterized Function Base<a class="headerlink" href="#parameterized-function-base" title="Permalink to this heading">#</a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN5mpart25ParameterizedFunctionBaseE">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MemorySpace</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParameterizedFunctionBase</span></span></span><a class="headerlink" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Subclassed by mpart::AffineFunction&lt; MemorySpace &gt;, <a class="reference internal" href="conditionalmapbase.html#classmpart_1_1_conditional_map_base"><span class="std std-ref">mpart::ConditionalMapBase&lt; MemorySpace &gt;</span></a>, <a class="reference internal" href="multivariateexpansion.html#classmpart_1_1_multivariate_expansion"><span class="std std-ref">mpart::MultivariateExpansion&lt; BasisEvaluatorType, MemorySpace &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase25ParameterizedFunctionBaseEjjj">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a8e48b2627e4bcaedbc047ed4eb7488f9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParameterizedFunctionBase</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inDim</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">outDim</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nCoeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase25ParameterizedFunctionBaseEjjj" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Construct a new parameterized function object. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inDim</strong> – The dimension <span class="math notranslate nohighlight">\(N\)</span> of the input to this map. </p></li>
<li><p><strong>outDim</strong> – The dimension <span class="math notranslate nohighlight">\(M\)</span> of the output from this map. </p></li>
<li><p><strong>nCoeffs</strong> – The number of coefficients in the parameterization. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBaseD0Ev">
<span class="target" id="classmpart_1_1_parameterized_function_base_1adaf918f901355ba571fc7093c8a9f02a"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~ParameterizedFunctionBase</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBaseD0Ev" title="Permalink to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase6CoeffsEv">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a5c965b299f6abc84fe7d0843d991351e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">View</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">Coeffs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase6CoeffsEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Returns a view containing the coefficients for this conditional map. This function returns a reference and can therefore be used to to update the coefficients or even set them to be a subview of a larger view. When the values of the larger view are updated, the subview stored by this class will also be updated. This is particularly convenient when simultaneously optimizing the coefficients over many conditional maps because each map can just use a slice into the larger vector of all coefficients that is updated by the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A reference to the Kokkos::View containing the coefficients. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase9SetCoeffsEN6Kokkos4ViewIPdN6Kokkos9HostSpaceEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1afdc944c0ee4c98d78d189eb5e65ba8e8"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetCoeffs</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">View</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">HostSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase9SetCoeffsEN6Kokkos4ViewIPdN6Kokkos9HostSpaceEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Set the internally stored view of coefficients. &#64;detail Performs a deep copy of the input coefficients to the internally stored coefficients. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coeffs</strong> – A view containing the coefficients to copy. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase10WrapCoeffsEN6Kokkos4ViewIPdN6Kokkos9HostSpaceEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a510e7329a43163230da0db10dc370a8e"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">WrapCoeffs</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">View</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">HostSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase10WrapCoeffsEN6Kokkos4ViewIPdN6Kokkos9HostSpaceEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Wrap the internal coefficient view around another view. &#64;detail Performs a shallow copy of the input coefficients to the internally stored coefficients. If values in the view passed to this function are changed, the values will also change in the internally stored view. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coeffs</strong> – A view containing the coefficients we want to wrap. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase9SetCoeffsEN5Eigen3RefIN5Eigen8VectorXdEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1af490295e6bd278534697b3cd61c23f1d"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetCoeffs</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VectorXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase9SetCoeffsEN5Eigen3RefIN5Eigen8VectorXdEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>SetCoeffs function with conversion from Eigen to Kokkos vector types. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase10WrapCoeffsEN5Eigen3RefIN5Eigen8VectorXdEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a92baef346a42a91fcfdc0c2fa615c6ad"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">WrapCoeffs</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VectorXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase10WrapCoeffsEN5Eigen3RefIN5Eigen8VectorXdEEE" title="Permalink to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase8CoeffMapEv">
<span class="target" id="classmpart_1_1_parameterized_function_base_1af2f830eb3a80918a5e393690a87943aa"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VectorXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CoeffMap</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase8CoeffMapEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Returns an eigen map wrapping around the coefficient vector, which is stored in a Kokkos::View. Updating the components of this map should also update the view. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK5mpart25ParameterizedFunctionBase6CoeffsEv">
<span class="target" id="classmpart_1_1_parameterized_function_base_1aa00ce74e8f528be09024f68c5bb476a1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">Kokkos</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">View</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Coeffs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK5mpart25ParameterizedFunctionBase6CoeffsEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Const version of the <a class="reference internal" href="#classmpart_1_1_parameterized_function_base_1a5c965b299f6abc84fe7d0843d991351e"><span class="std std-ref">Coeffs()</span></a> function. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixIdN8ViewType12memory_spaceEE8ViewType">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ViewType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1ae89e68ecaa36e9a9f11911c2e217aa09"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixIdN8ViewType12memory_spaceEE8ViewType" title="mpart::ParameterizedFunctionBase::Evaluate::ViewType"><span class="n"><span class="pre">ViewType</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">memory_space</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Evaluate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixIdN8ViewType12memory_spaceEE8ViewType" title="mpart::ParameterizedFunctionBase::Evaluate::ViewType"><span class="n"><span class="pre">ViewType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixIdN8ViewType12memory_spaceEE8ViewType" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate function with conversion between default view layout and const strided matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase8EvaluateERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a6b9a12ef454ef82be7a32f7c4bcce7d5"></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Evaluate</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase8EvaluateERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate function with conversion from Eigen to Kokkos (and possibly copy to/from device.) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AnyMemorySpace</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1a0efaab8f510e7a7b9927448c2b93ce9d"></span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::Evaluate::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Evaluate</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::Evaluate::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8EvaluateE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate the function at multiple points. </p>
<p>Computes <span class="math notranslate nohighlight">\(\mathbf{y}^{(i)}=T(\mathbf{x}^{(i)}; \mathbf{w})\)</span> for <span class="math notranslate nohighlight">\(N\)</span> points <span class="math notranslate nohighlight">\(\{\mathbf{x}^{(1)},\ldots,\mathbf{x}^{(N)}\}\)</span>. The parameters <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> are defined by the :code:<code class="docutils literal notranslate"><span class="pre">SetCoeffs</span></code> function. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A <span class="math notranslate nohighlight">\(d_{in}\times N\)</span> matrix containining <span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span> where this function be evaluated. Each column is a point. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <span class="math notranslate nohighlight">\(d_{out}\times N\)</span> matrix containing evaluations of this function. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase12EvaluateImplERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a1c30b4a87ff3550de8d614d3ae677989"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EvaluateImpl</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">output</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase12EvaluateImplERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Pure virtual EvaluateImpl function that is overridden by children of this class. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> – A <span class="math notranslate nohighlight">\(d_{in}\times N\)</span> matrix containining <span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span> where this function be evaluated. Each column is a point. </p></li>
<li><p><strong>output</strong> – A preallocated <span class="math notranslate nohighlight">\(d_{out}\times N\)</span> that will be filled with the evaluations. This matrix must be sized correctly before being passed into this function. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixIdN9ViewType112memory_spaceEE9ViewType19ViewType2">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ViewType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ViewType2</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1aad9580bb283e431606d30045552dbea6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixIdN9ViewType112memory_spaceEE9ViewType19ViewType2" title="mpart::ParameterizedFunctionBase::Gradient::ViewType1"><span class="n"><span class="pre">ViewType1</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">memory_space</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gradient</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixIdN9ViewType112memory_spaceEE9ViewType19ViewType2" title="mpart::ParameterizedFunctionBase::Gradient::ViewType1"><span class="n"><span class="pre">ViewType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pts</span></span>, <a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixIdN9ViewType112memory_spaceEE9ViewType19ViewType2" title="mpart::ParameterizedFunctionBase::Gradient::ViewType2"><span class="n"><span class="pre">ViewType2</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixIdN9ViewType112memory_spaceEE9ViewType19ViewType2" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate the gradient of the function with conversion between default view layout and const strided matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase8GradientERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a63cdd8ccbb83526d0ff54d5b56c7d89f"></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gradient</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase8GradientERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate the gradient of the function with conversion from Eigen to Kokkos (and possibly copy to/from device.) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AnyMemorySpace</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1a0500438f41aebc6b0c0c3d43718a52b1"></span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::Gradient::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gradient</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::Gradient::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::Gradient::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase8GradientE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluate the gradient of the function at multiple points. </p>
<p>For input points <span class="math notranslate nohighlight">\(x^{(i)}\)</span> and sensitivity vectors <span class="math notranslate nohighlight">\(s^{(i)}\)</span>, this function computes  <div class="math notranslate nohighlight">
\[
            g^{(i)} = \left[s^{(i)}\right]^T\nabla_x T(x^{(i)}; w),
         \]</div>
 where <span class="math notranslate nohighlight">\(\nabla_x T\)</span> is the Jacobian of the function <span class="math notranslate nohighlight">\(T\)</span> with respect to the input <span class="math notranslate nohighlight">\(x\)</span>. Note that this function can be used to evaluate one step of the chain rule (e.g., one backpropagation step). Given a scalar-valued function <span class="math notranslate nohighlight">\(g\)</span>, the gradient of <span class="math notranslate nohighlight">\(g(T(x))\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span> is given by <span class="math notranslate nohighlight">\(\left(\nabla g\right)^T \left(\nabla_x T\right)\)</span>. Passing <span class="math notranslate nohighlight">\(\nabla g\)</span> as the sensitivity input to this function then allows you to compute this product and thus the gradient of the composed function <span class="math notranslate nohighlight">\(g(T(x))\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> – A <span class="math notranslate nohighlight">\(d_{in}\times N\)</span> matrix containining <span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(\mathbb{R}^{d_{in}}\)</span> where this function be evaluated. Each column is a point. </p></li>
<li><p><strong>sens</strong> – A <span class="math notranslate nohighlight">\(d_{out}\times N\)</span> matrix containing <span class="math notranslate nohighlight">\(N\)</span> sensitivity vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^{d_{out}}\)</span>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <span class="math notranslate nohighlight">\(d_{in}\times N\)</span> matrix containing the gradient of vectors. Each column corresponds to the gradient at a particular point and sensitivity. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase12GradientImplERK13StridedMatrixIKd11MemorySpaceERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1abeb518bb322c4e9e01b33f0df421351a"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GradientImpl</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">output</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase12GradientImplERK13StridedMatrixIKd11MemorySpaceERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AnyMemorySpace</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1a87b6861813200f06657fb29cc4d6fe9b"></span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::CoeffGrad::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CoeffGrad</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::CoeffGrad::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="mpart::ParameterizedFunctionBase::CoeffGrad::AnyMemorySpace"><span class="n"><span class="pre">AnyMemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixId14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceERK13StridedMatrixIKd14AnyMemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Computes the gradient of the map output with respect to the map coefficients. </p>
<p>Consider a map <span class="math notranslate nohighlight">\(T(x; w) : \mathbb{R}^N \rightarrow \mathbb{R}^M\)</span> parameterized by coefficients <span class="math notranslate nohighlight">\(w\in\mathbb{R}^K\)</span>. This function computes  <div class="math notranslate nohighlight">
\[
            g_i = s_i^T\nabla_w T(x_i; w),
         \]</div>
 where <span class="math notranslate nohighlight">\(\nabla_w T(x_i; w)\in\mathbb{R}^{M\times K}\)</span> denotes the Jacobian of the map <span class="math notranslate nohighlight">\(T(x_i; w)\)</span> with respect to the coefficients at the single point <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(s_i\in \mathbb{R}^M\)</span> is a vector of sensitivities. Often the sensititivities <span class="math notranslate nohighlight">\(s_i\)</span> represent the gradient of some objective function with respect to the map output, i.e. <span class="math notranslate nohighlight">\(s_i = \nabla_{y_i} c(y_i)\)</span>, where <span class="math notranslate nohighlight">\(c:\mathbb{R}^M\rightarrow \mathbb{R}\)</span> is a scalar-valued objective function and <span class="math notranslate nohighlight">\(y_i=T(x_i;w)\)</span> is the output of the map. In this setting, the vector <span class="math notranslate nohighlight">\(g_i\)</span> computed by this function represents <span class="math notranslate nohighlight">\(g_i = \nabla_{w} c(T(x_i; w))\)</span>; and this function essentially computes a single step in the chain rule. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> – A collection of points <span class="math notranslate nohighlight">\(x_i\)</span> where we want to compute the Jacobian. Each column contains a single point. </p></li>
<li><p><strong>sens</strong> – A collection of sensitivity vectors <span class="math notranslate nohighlight">\(s_i\)</span> for each point. Each column is a single <span class="math notranslate nohighlight">\(s_i\)</span> vector and this view should therefore have the same number of columns as <code class="docutils literal notranslate"><span class="pre">pts</span></code>. It should also have <span class="math notranslate nohighlight">\(M\)</span> rows. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A collection of vectors <span class="math notranslate nohighlight">\(g_i\)</span>. Will have the same number of columns as pts with <span class="math notranslate nohighlight">\(K\)</span> rows. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixIdN11PtsViewType12memory_spaceEE11PtsViewType12SensViewType">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PtsViewType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SensViewType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classmpart_1_1_parameterized_function_base_1a40fc821b03ae240faffabb5a7b23a6cd"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixIdN11PtsViewType12memory_spaceEE11PtsViewType12SensViewType" title="mpart::ParameterizedFunctionBase::CoeffGrad::PtsViewType"><span class="n"><span class="pre">PtsViewType</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">memory_space</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CoeffGrad</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixIdN11PtsViewType12memory_spaceEE11PtsViewType12SensViewType" title="mpart::ParameterizedFunctionBase::CoeffGrad::PtsViewType"><span class="n"><span class="pre">PtsViewType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pts</span></span>, <a class="reference internal" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixIdN11PtsViewType12memory_spaceEE11PtsViewType12SensViewType" title="mpart::ParameterizedFunctionBase::CoeffGrad::SensViewType"><span class="n"><span class="pre">SensViewType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN5mpart25ParameterizedFunctionBase9CoeffGradE13StridedMatrixIdN11PtsViewType12memory_spaceEE11PtsViewType12SensViewType" title="Permalink to this definition">#</a><br /></dt>
<dd><p>CoeffGrad function with conversion between general view type and const strided matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase9CoeffGradERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a98d648ab25961be5bd219f201a9b6821"></span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CoeffGrad</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Ref</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Eigen</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">RowMatrixXd</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase9CoeffGradERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEERKN5Eigen3RefIKN5Eigen11RowMatrixXdEEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Coeff grad function with conversion between Eigen and Kokkos matrix types. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase13CoeffGradImplERK13StridedMatrixIKd11MemorySpaceERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a1512192c4a2b269bc226711db6b84573"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CoeffGradImpl</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pts</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sens</span></span>, <span class="n"><span class="pre">StridedMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN5mpart25ParameterizedFunctionBaseE" title="mpart::ParameterizedFunctionBase::MemorySpace"><span class="n"><span class="pre">MemorySpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">output</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase13CoeffGradImplERK13StridedMatrixIKd11MemorySpaceERK13StridedMatrixIKd11MemorySpaceE13StridedMatrixId11MemorySpaceE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Pure virtual function overridden by child classes for computing the gradient of the function output with respect to the parameter vector <span class="math notranslate nohighlight">\(\mathbf{w}\)</span>. See the non-virtual CoeffGrad function for more details. </p>
<p>Evaluates the gradient with respect to the coefficients and stores the results in a preallocated matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> – A <span class="math notranslate nohighlight">\(d_{in}\times N\)</span> matrix containining <span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span> where this function be evaluated. Each column is a point. </p></li>
<li><p><strong>sens</strong> – A matrix of sensitivity vectors. Each column contains one sensitivity. </p></li>
<li><p><strong>output</strong> – A preallocated matrix to store the results. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase8inputDimE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1ad377f147cbb93fd3ea777b5a935a6efa"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inputDim</span></span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase8inputDimE" title="Permalink to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase9outputDimE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1a938f66d7ca0d5d2046280dc1ba2cb396"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">outputDim</span></span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase9outputDimE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The total dimension of the input N+M. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N5mpart25ParameterizedFunctionBase9numCoeffsE">
<span class="target" id="classmpart_1_1_parameterized_function_base_1adcebafd1d75ba39a8d37af03cef7e027"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">numCoeffs</span></span></span><a class="headerlink" href="#_CPPv4N5mpart25ParameterizedFunctionBase9numCoeffsE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The output dimension M. </p>
</dd></dl>

</div>
</dd></dl>

</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../_sources/source/api/parameterizedfunctionbase.rst.txt">
        <i class="fas fa-file-alt"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, The MParT development team..<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>