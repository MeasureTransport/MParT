
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MultiIndices &#8212; MParT  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MultiIndex" href="multiindices/multiindex.html" />
    <link rel="prev" title="Monotone Component" href="monotonecomponent.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">MParT  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../development/index.html">
  Development
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/MeasureTransport/MParT" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="templateconcepts.html">
   Template Concepts
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="concepts/cachedparameterization.html">
     Cached Parameterization Concept
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="multivariateexpansion.html">
       Multivariate Expansion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tensorproductfunction.html">
       Tensor Product Function
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="concepts/parameterizedfunction.html">
     Parameterized Function Concept
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="monotonecomponent.html">
       Monotone Component
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   MultiIndices
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="multiindices/multiindex.html">
     MultiIndex
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multiindices/multiindexset.html">
     MultiIndexSet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multiindices/fixedmultiindexset.html">
     FixedMultiIndexSet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multiindices/multiindexlimiter.html">
     MultiIndexLimiter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multiindices/multiindexneighborhood.html">
     MultiIndexNeighborhood
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="quadrature.html">
   Quadrature
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="quadrature/clenshawcurtis.html">
     Clenshaw Curtis Quadrature
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="quadrature/adaptivesimpson.html">
     Adaptive Simpson Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="quadrature/recursivequadrature.html">
     Recursive Adaptive Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utilities/kokkoswrappers.html">
   Kokkos Array Conversions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monotonecomponent.html">
   Monotone Component
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariateexpansion.html">
   Multivariate Expansion
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-objects">
   C++ Objects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions">
   Definitions
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="multiindices">
<h1>MultiIndices<a class="headerlink" href="#multiindices" title="Permalink to this heading">#</a></h1>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<p>A multiindex is simply a length <span class="math notranslate nohighlight">\(D\)</span> vector of nonnegative integers <span class="math notranslate nohighlight">\(\mathbf{p}=[p_1,p_2,\dots,p_D]\)</span>.
Multiindices are commonly employed for defining multivariate polynomial expansions and other function parameterizations.
In these cases, sets of multiindices define the form of the expansion.</p>
<p><strong>Example: Multivariate Polynomial</strong></p>
<p>A multivariate polynomial <span class="math notranslate nohighlight">\(\Phi_{\mathbf{p}}(\mathbf{x}) : \mathbb{R}^D\rightarrow R\)</span> can be defined as the
product of <span class="math notranslate nohighlight">\(D\)</span> univariate polynomials.   Using monomials for example,</p>
<div class="math notranslate nohighlight">
\[\Phi_{\mathbf{p}}(\mathbf{x}) = \prod_{i=1}^D x_i^{p_i}\]</div>
<p>A multivariate polynomial expansion can then be written succinctly as</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{x}) = \sum_{\mathbf{p}\in\mathcal{S}} c_{\mathbf{p}} \Phi_{\mathbf{p}}(\mathbf{x})\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> is a set of multiindices and <span class="math notranslate nohighlight">\(c_{\mathbf{p}}\)</span> are scalar coefficients.</p>
<p><strong>Example: Wavelets</strong></p>
<p>Multivariate polynomials are constructed from a tensor product of one-dimensional functions and each
one-dimensional function depends on a single integer: the degree of the one-dimensional polynomial.   This is a common
way to define multivariate functions from indexed families of one-dimensional basis functions.  In a general
setting, however, the one-dimensional family does not need to be index by a single integer.  Families of
one-dimensional functions indexed with multiple integers can also be “tensorized” into multivariate functions.
Wavelets are a prime example of this.</p>
<p>A one dimensional wavelet basis contains functions of the form</p>
<div class="math notranslate nohighlight">
\[\psi_{j,k}(x) = 2^{j/2}\psi(2^jx -k)\]</div>
<p>where <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(k\)</span> are integers and <span class="math notranslate nohighlight">\(\psi :\mathbb{R}\rightarrow \mathbb{R}\)</span> is an orthogonal wavelet.
Unlike polynomials, two integers are required to index the one-dimensional family. Nevertheless, a multivariate wavelet
basis can be defined through the tensor product of components in this family:</p>
<div class="math notranslate nohighlight">
\[\Psi_{\mathbf{p}}(\mathbf{x}) = \prod_{i=1}^{D/2} \psi_{p_{2i},p_{2i+1}}(x_i)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Psi_{\mathbf{p}} : \mathbb{R}^{D/2}\rightarrow \mathbb{R}\)</span> is a multivariate wavelet basis function in
<span class="math notranslate nohighlight">\(D/2\)</span> dimensions and <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> is a multiindex with <span class="math notranslate nohighlight">\(D\)</span> components.</p>
</section>
<section id="c-objects">
<h2>C++ Objects<a class="headerlink" href="#c-objects" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="multiindices/multiindex.html">MultiIndex</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiindices/multiindexset.html">MultiIndexSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiindices/fixedmultiindexset.html">FixedMultiIndexSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiindices/multiindexlimiter.html">MultiIndexLimiter</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiindices/multiindexneighborhood.html">MultiIndexNeighborhood</a></li>
</ul>
</div>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this heading">#</a></h2>
<aside class="topic">
<p class="topic-title">Limiting Set</p>
<p>In general, any length <span class="math notranslate nohighlight">\(D\)</span> vector in <span class="math notranslate nohighlight">\(\mathbb{N}^D\)</span> is a multiindex.  In many adaptive approaches, however,
it is useful to only consider multiindices in some subset <span class="math notranslate nohighlight">\(\mathcal{G}\subseteq \mathbb{N}^D\)</span>.   We call this subset
the limiting set or, more loosely, the “limiter”.   In MParT, limiting sets are defined by functors that accept a
MultiIndex and return <cite>true</cite> if the multiindex is in <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> and <cite>false</cite> otherwise.  Some predefined limiting
sets are defined in the MultiIndexLimiter namespace, but custom functors can also be employed.</p>
</aside>
<aside class="topic">
<p class="topic-title">Neighbors</p>
<p>In most parameterization applications, there is additional structure in the multiindex set that can be represented
through edges on a graph.   Each multiindex can be treated as a node in directed graph.  Outgoing edges connect to
other multiindices, which we call “forward neighbors”, that represent higher order basis functions.   Incoming edges
come from multiindices, which we call “backward neighbors”, that represent lower order basis functions.</p>
<p>In the multivariate polynomial example above, the backward neighbors of a multiindex <span class="math notranslate nohighlight">\(\mathbf{j}\)</span> are the multiindices
that only differ from <span class="math notranslate nohighlight">\(\mbox{j}\)</span> in one component, and in that component, the difference is -1.  More precisely,
the set of backward neighbors is</p>
<div class="math notranslate nohighlight">
\[\mathcal{B}_{\mathbf{j}} = \{\mathbf{i} : \|\mathbf{i}-\mathbf{j}\|_1=1 \text{ and } \mathbf{i}_k \leq \mathbf{j}_k \text{ for all } k \}.\]</div>
<p>The set of forward neighbors is similarly defined as</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}_{\mathbf{j}} = \{\mathbf{i} : \|\mathbf{i}-\mathbf{j}\|_1=1 \text{ and } \mathbf{i}_k \geq \mathbf{j}_k \text{ for all } k \}\]</div>
<p>The neighborhood structure of a multindex set is defined through a child of the abstract MultiIndexNeighborhood class.</p>
</aside>
<aside class="topic">
<p class="topic-title">Downward Closed</p>
<p>A multiindex set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> is downward closed if for any multiindex <span class="math notranslate nohighlight">\(\mathbf{j}\in\mathcal{S}\)</span>, all
backward neighbors of <span class="math notranslate nohighlight">\(\mathbf{j}\)</span> are also in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
</aside>
<aside class="topic">
<p class="topic-title">Margin</p>
<p>For a multindex set <span class="math notranslate nohighlight">\(\mathcal{S}\subseteq\mathcal{G}\)</span>, the margin of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> is the set
<span class="math notranslate nohighlight">\(\mathcal{M} \in \mathcal{G}\setminus\mathcal{S}\)</span> containing indices that have at least one backward neighbor
in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
</aside>
<aside class="topic">
<p class="topic-title">Reduced Margin</p>
<p>The reduced margin <span class="math notranslate nohighlight">\(\mathcal{M}_r\subseteq\mathcal{M}\)</span> is a subset of the margin <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> containing
indices that could be added to the set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> while preserving the downward closed property of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.
Multiindices in the reduced margin are often called admissible.</p>
</aside>
<aside class="topic">
<p class="topic-title">Active/Inactive Indices</p>
<p>The MultiIndexSet class stores both the set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> and the margin <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>.   In MParT,
multiindices in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> are sometimes called active, while multiindices in <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> are called inactive.
Only active indices are included in the linear indexing.  Inactive
indices are hidden (i.e. not even considered) in all the public members
of this class.  Inactive multiindices are used behind the scenes to check admissability, to define the margin, and
are added to the <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> during adaptation.</p>
</aside>
<aside class="topic">
<p class="topic-title">Frontier</p>
<p>The Frontier is similar but contains multiindices in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> that have at least one forward neighbor in
the margin <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>.   We use the term “strict frontier” to describe the set of multiindices in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> that have all of their forward neighbors in the margin.</p>
</aside>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="monotonecomponent.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Monotone Component</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="multiindices/multiindex.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">MultiIndex</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, The MParT development team..<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>